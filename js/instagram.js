var Instagram=function(){var t=[],i=function(t){for(var i in t)for(var e=0,a=t[i].srclist.length;a>e;e++){var n=t[i].bigSrclist[e],r=new Image;r.src=n}},e=function(t){for(var e in t){for(var a="",n=0,r=t[e].srclist.length;r>n;n++)a+='<li>								<div class="img-box">									<a class="img-bg" rel="example_group" href="'+t[e].bigSrclist[n]+'" title="'+t[e].text[n]+'"></a>									<img lazy-src="'+t[e].srclist[n]+'" alt="">								</div>							</li>';$('<section class="archives album"><h1 class="year">'+t[e].year+"<em>"+t[e].month+'月</em></h1>				<ul class="img-box-ul">'+a+"</ul>				</section>").appendTo($(".instagram"))}$(".instagram").lazyload(),o(),setTimeout(function(){i(t)},3e3),$("a[rel=example_group]").fancybox()},a=function(t){if(t.indexOf("outbound-distilleryimage")>=0){var i=t.match(/outbound-distilleryimage([\s\S]*?)\//)[1],e=t.split("/");return"http://distilleryimage"+i+".ak.instagram.com/"+e[e.length-1]}var a="http://photos-g.ak.instagram.com/hphotos-ak-xpf1/",e=t.split("/");return a+e[e.length-1]},n=function(t){for(var i={},n=0,r=t.length;r>n;n++){var o=new Date(1e3*t[n].created_time),s=o.getFullYear(),l=o.getMonth()+1,c=a(t[n].images.low_resolution.url),u=a(t[n].images.standard_resolution.url),m=t[n].caption.text,g=s+"-"+l;i[g]?(i[g].srclist.push(c),i[g].bigSrclist.push(u),i[g].text.push(m)):i[g]={year:s,month:l,srclist:[u],bigSrclist:[u],text:[m]}}e(i)},r=function(i){$(".open-ins").html("图片来自instagram，正在加载中…"),$.ajax({url:i,type:"GET",dataType:"jsonp",success:function(i){if(200==i.meta.code){t=t.concat(i.data);var e=i.pagination.next_url;e?r(e):($(".open-ins").html("图片来自instagram，点此访问"),n(t))}else alert("access_token timeout!")}})},o=function(){if($(document).width()<=600)$(".img-box").css({width:"auto",height:"auto"});else{var t=$(".img-box-ul").width(),i=Math.max(.26*t,157);$(".img-box").width(i).height(i)}},s=function(){$(window).resize(function(){o()})};return{init:function(){var t=$(".instagram").attr("data-client-id");return t?(r("https://api.instagram.com/v1/users/438522285/media/recent/?client_id="+t+"&count=100"),void s()):(alert("Didn't set your instagram client_id.\nPlease see the info on the console of your brower."),void console.log("Please open 'http://instagram.com/developer/clients/manage/' to get your client-id."))}}}();$(function(){Instagram.init()});